<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>ğŸšš RuntimeError: stack expects each tensor to be equal size, but got [32] at entry 0 and [24] at entry 1 - AI/Business Study Log</title>
<meta name="description" content="Pytorch Error: Dataloader get non-equal size of tensor">


  <meta name="author" content="qcqced">
  
  <meta property="article:author" content="qcqced">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="AI/Business Study Log">
<meta property="og:title" content="ğŸšš RuntimeError: stack expects each tensor to be equal size, but got [32] at entry 0 and [24] at entry 1">
<meta property="og:url" content="http://localhost:4000/framework-library/dataloader-collatefn">


  <meta property="og:description" content="Pytorch Error: Dataloader get non-equal size of tensor">







  <meta property="article:published_time" content="2023-07-11T00:00:00+09:00">



  <meta property="article:modified_time" content="2023-07-12T13:00:00+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/framework-library/dataloader-collatefn">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "qcqced",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="AI/Business Study Log Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<!-- Latex -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
<link rel="manifest" href="/assets/site.webmanifest">
<link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        equationNumbers: {
          autoNumber: "AMS"
        }
      },
      tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$'] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
      alert("Math Processing Error: "+message[1]);
    });
  MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
      alert("Math Processing Error: "+message[1]);
    });
  </script>
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          AI/Business Study Log
          <span class="site-subtitle">NLP, Marketing</span>
        </a>
        
        
        <ul class="visible-links">
              
              
                  <li class="masthead__menu-item">
                      <a href="https://qcqced123.github.io/">Home</a>
                  </li>
              
          
              
              
                  <li class="dropdown ">
                      <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CS/AI  <i class="fa fa-caret-down fa-sm" aria-hidden="true"></i><span class="caret"></span></a>
       
                      <ul class="dropdown-content" >
                          
                              <a class = "dropdown-item" href="/nlp/">    Natural Language Process</a>
                          
                              <a class = "dropdown-item" href="/multi-modal/">    Multi Modal</a>
                          
                              <a class = "dropdown-item" href="/cv/">    Computer Vision</a>
                          
                              <a class = "dropdown-item" href="/ml/">    Machine Learning</a>
                          
                              <a class = "dropdown-item" href="/framework-library/">    Framework & Library</a>
                          
                              <a class = "dropdown-item" href="/python/">    Python</a>
                          
                              <a class = "dropdown-item" href="/algorithm/">    Algorithm</a>
                          
                      </ul>
                  </li>
              
          
              
              
                  <li class="dropdown ">
                      <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Math  <i class="fa fa-caret-down fa-sm" aria-hidden="true"></i><span class="caret"></span></a>
       
                      <ul class="dropdown-content" >
                          
                              <a class = "dropdown-item" href="/linear-algebra/">    Linear Algebra</a>
                          
                              <a class = "dropdown-item" href="/calculus/">    Calculus</a>
                          
                              <a class = "dropdown-item" href="/optimization-theory/">    Optimization Theory</a>
                          
                              <a class = "dropdown-item" href="/signal-system/">    Signal & System</a>
                          
                      </ul>
                  </li>
              
          
              
              
                  <li class="dropdown ">
                      <a class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Business/Marketing  <i class="fa fa-caret-down fa-sm" aria-hidden="true"></i><span class="caret"></span></a>
       
                      <ul class="dropdown-content" >
                          
                              <a class = "dropdown-item" href="/device/">    Device</a>
                          
                              <a class = "dropdown-item" href="/semi-conductor/">    Semi-Conductor</a>
                          
                              <a class = "dropdown-item" href="/ai/">    AI</a>
                          
                      </ul>
                  </li>
              
          
              
              
                  <li class="masthead__menu-item">
                      <a href="/categories/">Category</a>
                  </li>
              
          
              
              
                  <li class="masthead__menu-item">
                      <a href="/about/">About</a>
                  </li>
              
          
       </ul>
       
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/huggingface_emoji.png" alt="qcqced" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">qcqced</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Interested in NLP, Marketing</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Seoul, South Korea</span>
        </li>
      

      
        
          
            <li><a href="https://qcqced123.github.io" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://github.com/qcqced123" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.kaggle.com/qcqced" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-kaggle" aria-hidden="true"></i><span class="label">Kaggle</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:qcqced123@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="qcqced123@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="ğŸšš RuntimeError: stack expects each tensor to be equal size, but got [32] at entry 0 and [24] at entry 1">
    <meta itemprop="description" content="Pytorch Error: Dataloader get non-equal size of tensor">
    <meta itemprop="datePublished" content="2023-07-11T00:00:00+09:00">
    <meta itemprop="dateModified" content="2023-07-12T13:00:00+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/framework-library/dataloader-collatefn" class="u-url" itemprop="url">ğŸšš RuntimeError: stack expects each tensor to be equal size, but got [32] at entry 0 and [24] at entry 1
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#-ê°€ë³€-ê¸¸ì´ì˜-í…ì„œë¥¼-ë°ì´í„°ë¡œë”ì—-ì „ë‹¬í•˜ëŠ”-ê²½ìš°-">ğŸ“ ê°€ë³€ ê¸¸ì´ì˜ í…ì„œë¥¼ ë°ì´í„°ë¡œë”ì— ì „ë‹¬í•˜ëŠ” ê²½ìš° </a></li></ul>

            </nav>
          </aside>
        
        <h3 id="-ê°€ë³€-ê¸¸ì´ì˜-í…ì„œë¥¼-ë°ì´í„°ë¡œë”ì—-ì „ë‹¬í•˜ëŠ”-ê²½ìš°-"><code class="language-plaintext highlighter-rouge">ğŸ“ ê°€ë³€ ê¸¸ì´ì˜ í…ì„œë¥¼ ë°ì´í„°ë¡œë”ì— ì „ë‹¬í•˜ëŠ” ê²½ìš° </code></h3>

<p>ì»¤ìŠ¤í…€ ë°ì´í„° í´ë˜ìŠ¤ì™€ ë°ì´í„°ë¡œë”ë¥¼ í†µí•´ ë°˜í™˜ë˜ëŠ” ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ì˜ í…ì„œ í¬ê¸°ê°€ ì¼ì •í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë‹¤. íŠ¹íˆ ìì—°ì–´ ì²˜ë¦¬ì—ì„œ ìì£¼ ì°¾ì•„ ë³¼ ìˆ˜ ìˆëŠ”ë° ë°ì´í„°ë¡œë” ê°ì²´ ì„ ì–¸ ì‹œ, ë§¤ê°œë³€ìˆ˜ ì˜µì…˜ ì¤‘ì— <code class="language-plaintext highlighter-rouge">collate_fn=collate</code> ë¥¼ ì¶”ê°€í•´ì£¼ë©´ í•´ê²° ê°€ëŠ¥í•œ ì—ëŸ¬ë‹¤. ì´ ë•Œ ë§¤ê°œë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">collate_fn</code> ì— ì „ë‹¬í•˜ëŠ” ê°’(ë©”ì„œë“œ)ì€ ì‚¬ìš©ìê°€ ì§ì ‘ ì •ì˜í•´ì¤˜ì•¼ í•œë‹¤. í—ˆê¹…í˜ì´ìŠ¤ ë¼ì´ë¸Œë¦¬ëŸ¬ì— ìƒí™©ì— ë§ê²Œ ë¯¸ë¦¬ ì œì‘ëœ <code class="language-plaintext highlighter-rouge">collate</code> ë©”ì„œë“œë¥¼ ì§€ì›í•´ì£¼ê³  ìˆê¸° ë•Œë¬¸ì— ì˜ ì´ìš©í•˜ë©´ ëœë‹¤. í•„ìì˜ ê²½ìš°ì—ëŠ” ì»¤ìŠ¤í…€ìœ¼ë¡œ ì§ì ‘ ì •ì˜í•œ ë©”ì„œë“œ, ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„° ë¡œë” ì˜ˆì‹œ
</span><span class="n">loader_train</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">cfg</span><span class="p">.</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
            <span class="n">collate_fn</span><span class="o">=</span><span class="n">MiniBatchCollate</span><span class="p">,</span>  <span class="c1"># ì—¬ê¸°ì— ì‚¬ìš©í•˜ë ¤ëŠ” collate function í˜¹ì€ ê°ì²´ë¥¼ ì „ë‹¬í•˜ì!!
</span>            <span class="n">generator</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">generator</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">cfg</span><span class="p">.</span><span class="n">num_workers</span><span class="p">,</span>
            <span class="n">pin_memory</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="p">)</span>

<span class="c1"># collate ë©”ì„œë“œ ì˜ˆì‹œ: 
</span><span class="k">class</span> <span class="nc">MiniBatchCollate</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""
    Collate class for torch.utils.data.DataLoader  
    This class object to use variable data such as NLP text sequence
    If you use static padding with AutoTokenizer, you don't need this class 
    But if you use dynamic padding with AutoTokenizer, you must use this class object &amp; call
    Args:
        batch: data instance from torch.utils.data.DataSet
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">batch</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">],</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">position_list</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">batch</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">rnn</span><span class="p">.</span><span class="n">pad_sequence</span><span class="p">(</span>
            <span class="n">labels</span><span class="p">,</span>
            <span class="n">batch_first</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">padding_value</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">position_list</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">rnn</span><span class="p">.</span><span class="n">pad_sequence</span><span class="p">(</span>
            <span class="n">position_list</span><span class="p">,</span>
            <span class="n">batch_first</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">padding_value</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">position_list</span>

<span class="k">def</span> <span class="nf">collate</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
    <span class="s">"""
    slice input sequence by maximum length sequence in mini-batch, used for speed up training
    if you want slice other variable such as label feature, you can add param on them
    This Function should be used after DataLoader return mini-batch instance
    Args:
        inputs: list of dict, dict has keys of "input_ids", "attention_mask", "token_type_ids"    
    """</span>
    <span class="n">mask_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="s">"attention_mask"</span><span class="p">].</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="nb">max</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">inputs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="p">:</span><span class="n">mask_len</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div></div>

<p>ì¼ë°˜ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">collate</code> ëŠ” ë©”ì„œë“œë¡œ êµ¬í˜„í•´ì„œ ì‚¬ìš©í•˜ì§€ë§Œ, ìœ„ ì½”ë“œì²˜ëŸ¼ ê°ì²´ë¡œ êµ¬í˜„í•˜ê³  ë‚´ë¶€ì— <code class="language-plaintext highlighter-rouge">__call__</code> ë¥¼ ì •ì˜í•´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤. í•„ì ì—­ì‹œ ë‹¨ì¼ ë©”ì„œë“œ í˜•íƒœë¥¼ ê³„ì†í•´ì„œ ì‚¬ìš©í•˜ë‹¤ê°€ ìµœê·¼ ë“¤ì–´ ì—í­ í•œ ë²ˆì— ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° ì„¸íŠ¸ ë° ëª¨ë¸ì„ í›ˆë ¨ ì‹œì¼œì•¼ í•˜ëŠ” ìƒí™©ì„ ë§ˆì£¼í•œ ì´í›„ ê°ì²´ í˜•íƒœë¡œ ë‹¤ì‹œ êµ¬í˜„í•´ ì‚¬ìš©í•˜ê³  ìˆë‹¤.</p>

<p>í•œí¸ ì˜ˆì‹œ ì½”ë“œ ê°€ì¥ ë§ˆì§€ë§‰ <code class="language-plaintext highlighter-rouge">collate</code> ë©”ì„œë“œëŠ” ì…ë ¥ ì‹œí€€ìŠ¤ê°€ huggingfaceì˜ <code class="language-plaintext highlighter-rouge">AutoTokenizer.encode_plus</code> ë¥¼ ì´ìš©í•´ ì‚¬ìš©ì ì§€ì • <code class="language-plaintext highlighter-rouge">max_len</code>ê¹Œì§€ íŒ¨ë”©ì„ ë§ˆì¹œ ìƒíƒœë¼ëŠ” ê°€ì •í•˜ì— êµ¬í˜„ ë˜ì—ˆë‹¤. í•´ë‹¹ ë©”ì„œë“œëŠ” ìœ„ì— ë°œìƒí•œ ì—ëŸ¬ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•¨ë³´ë‹¤, ë¯¸ë‹ˆ ë°°ì¹˜ì— ì†í•œ ì „ì²´ ë°ì´í„° ì¤‘ì—ì„œ ìµœëŒ€ ê¸¸ì´ê°€ ì‚¬ìš©ì ì§€ì • <code class="language-plaintext highlighter-rouge">max_len</code>ê¹Œì§€ ë¯¸ì¹˜ì§€ ëª»í•˜ëŠ”ë° íŒ¨ë”©ì´ ëœ ê²½ìš°ì— ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë§Œë“¤ì—ˆë‹¤. ë¶ˆí•„ìš”í•œ íŒ¨ë”©ì„ <code class="language-plaintext highlighter-rouge">trucation</code> í•˜ì—¬ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì˜ í•™ìŠµ ì†ë„ë¥¼ ë†’ì´ê¸° ìœ„í•¨ì´ë‹¤. í•´ë‹¹ ë©”ì„œë“œëŠ” í¬ìŠ¤íŒ…ì˜ ì œëª©ì— ë‹¬ë¦° ì—ëŸ¬ë¥¼ í•´ê²°í•˜ëŠ”ë° ì‚¬ìš©í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ  <code class="language-plaintext highlighter-rouge">collate</code> ê¸°ëŠ¥ì„ ì–¸ê¸‰í•˜ëŠ” ê¹€ì— ìƒê°ì´ë‚˜ ê°™ì´ ì •ë¦¬í•´ë´¤ë‹¤. ì´ ë©”ì„œë“œëŠ” <code class="language-plaintext highlighter-rouge">torch.utils.data.DataLoader</code> ì˜ ì¸ìê°€ ì•„ë‹ˆë¼, ë©”ì¸ í•™ìŠµ ë£¨í”„ ë‚´ë¶€ì— ì‚¬ìš©í•œë‹¤. ë‹¤ì‹œ ë§í•´, ë°ì´í„°ë¡œë”ê°€ ë°°ì¹˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œ ë‹¤ìŒ ì‚¬ìš©í•˜ë©´ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. íŒ¨ë”©ë°©ì‹ê³¼ <code class="language-plaintext highlighter-rouge">collate</code> ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ ë‹¤ë¥¸ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£¨ë„ë¡ í•˜ê² ë‹¤.</p>

<p>ë°˜ë©´ <code class="language-plaintext highlighter-rouge">MiniBatchCollate</code> ê°ì²´ëŠ” <code class="language-plaintext highlighter-rouge">torch.utils.data.DataLoader</code> ì˜ <code class="language-plaintext highlighter-rouge">collate_fn</code> ì¸ìì— ì „ë‹¬í•˜ë©´ ëœë‹¤. í•„ìì˜ ê²½ìš°ëŠ” <code class="language-plaintext highlighter-rouge">Dynamic Padding</code> ê¸°ë²•ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë¯¸ë‹ˆ ë°°ì¹˜ ë‚´ë¶€ì˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ì´ ì„œë¡œ ë‹¤ë¥¸ ì‹œí€€ìŠ¤ ê¸¸ì´ë¥¼ ê°–ëŠ” ê²½ìš°ê°€ ë°œìƒí•œë‹¤. ë°ì´í„°ë¡œë”ëŠ” ë¯¸ë‹ˆ ë°°ì¹˜ì— ì†í•˜ëŠ” ë°ì´í„°ì˜ ê¸¸ì´ê°€ í†µì¼ë˜ì§€ ì•Šìœ¼ë©´ ë°°ì¹˜ ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ ë¬¶ì„ ìˆ˜ ì—†ê²Œ ëœë‹¤. ë”°ë¼ì„œ ë¯¸ë‹ˆ ë°°ì¹˜ ë‹¨ìœ„ì˜ ê¸¸ì´ í†µì¼ì„ ìœ„í•´ <code class="language-plaintext highlighter-rouge">torch.nn.utils.rnn.pad_sequence</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. ì´ ë©”ì„œë“œëŠ” ì…ë ¥í•œ ë¯¸ë‹ˆ ë°°ì¹˜ ë°ì´í„° ì¤‘ì—ì„œ ê°€ì¥ ê¸´ ì‹œí€€ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë“  ë°ì´í„° ê¸¸ì´ë¥¼ í†µì¼í•œë‹¤. <code class="language-plaintext highlighter-rouge">batch_first=True</code> ë¥¼ ì£¼ëª©í•˜ì. ì´ ì¸ìë¥¼ <code class="language-plaintext highlighter-rouge">False</code> ë¡œ ì„¤ì •í•  ê²½ìš°, ë°°ì¹˜ ì°¨ì›ì´ ë§¨ ì•ì´ ì•„ë‹ˆë¼ ì¤‘ê°„ì— ì •ì˜ëœë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” ë°°ì¹˜ ì°¨ì›ì„ ë§¨ ì•ì— ë‘ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê¼­ í•´ë‹¹ ì¸ìë¥¼ <code class="language-plaintext highlighter-rouge">True</code> ë¡œ ì„¤ì •í•˜ê³  ì‚¬ìš©í•˜ì.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#collate-fn" class="page__taxonomy-item p-category" rel="tag">collate_fn</a><span class="sep">, </span>
    
      <a href="/tags/#dataloader" class="page__taxonomy-item p-category" rel="tag">DataLoader</a><span class="sep">, </span>
    
      <a href="/tags/#dynamic-padding" class="page__taxonomy-item p-category" rel="tag">Dynamic Padding</a><span class="sep">, </span>
    
      <a href="/tags/#padding" class="page__taxonomy-item p-category" rel="tag">Padding</a><span class="sep">, </span>
    
      <a href="/tags/#pytorch" class="page__taxonomy-item p-category" rel="tag">Pytorch</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#framework-library" class="page__taxonomy-item p-category" rel="tag">Framework & Library</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-07-11">July 11, 2023</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%F0%9F%9A%9A+RuntimeError%3A+stack+expects+each+tensor+to+be+equal+size%2C+but+got+%5B32%5D+at+entry+0+and+%5B24%5D+at+entry+1%20http%3A%2F%2Flocalhost%3A4000%2Fframework-library%2Fdataloader-collatefn" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fframework-library%2Fdataloader-collatefn" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fframework-library%2Fdataloader-collatefn" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/framework-library/cuda-num/" class="pagination--pager" title="ğŸ–¥ï¸ RuntimeError: Attempting to deserialize object on CUDA device 2 but torch.cuda.device_count() is 1. Please use torch.load with map_location to map your storages to an existing device
">Previous</a>
    
    
      <a href="/framework-library/inf-per-device" class="pagination--pager" title="ğŸª¢ assert len(optimizer_state[â€œfound_inf_per_deviceâ€]) &gt; 0, â€œNo inf checks were recorded for this optimizer.â€ AssertionError: No inf checks were recorded for this optimizer.
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/huggingface_emoji.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/framework-library/" rel="permalink">ğŸ”¥Â Pytorch Tensor Indexing ìì£¼ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œ ëª¨ìŒì§‘
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">íŒŒì´í† ì¹˜ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” í…ì„œ ì¸ë±ì‹± ê´€ë ¨ ë©”ì„œë“œ ëª¨ìŒ
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/huggingface_emoji.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/calculus/gradient" rel="permalink">ğŸ“ˆÂ Gradient: Directional Derivative
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Proof of gradient direction with Total Derivative
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/huggingface_emoji.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cv/vit" rel="permalink">ğŸŒ†Â [ViT] An Image Is Worth 16x16 Words: Transformers For Image Recognition At Scale
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          25 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ViT Official Papaer Review with Pytorch Implementation
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/huggingface_emoji.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/linear-algebra/vector-subspace" rel="permalink">ğŸ”¢Â Vector Space: Column Space, Basis, Rank, Null Space
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ğŸ’¡ Concept of main sub-space
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 qcqced. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'qcqced123/qcqced123.github.io');
    script.setAttribute('issue-term', 'pathname');
    
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  




<script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
});
</script>

  </body>
</html>
