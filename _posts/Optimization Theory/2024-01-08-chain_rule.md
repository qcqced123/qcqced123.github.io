---
title: "📈 Chain Rule: 합성함수 미분법"
excerpt: "합성함수 미분법 공식 유도"
permalink: "/optimization-theory/chain-rule"
toc: true  # option for table of content
toc_sticky: true  # option for table of content
categories:
  - Calculus
tags:
  - Calculus
  
last_modified_at: 2024-01-08T09:00:00-05:00
---

`Chain Rule` 이라고 불리기도 하는 합성함수 미분법은 미적분학에서 특히나 중요한 개념 중 하나다. 근래에는 신경망을 활용한 딥러닝이 주목받으면서 그 중요성이 더욱 부각되고 있다. 신경망 모델은 쉽게 생각하면 정말 많은 1차함수와 여러 활성함수를 합성한 것과 같기 때문이다. 따라서 오차 역전을 통해 가중치를 최적화 하는 과정을 정확히 이해하려면 합성함수 미분법에 대한 이해는 필수적이다.

### `💡 Concept`

합성함수 미분을 이해하기 전에 먼저 도함수 표기법에 대해서 익숙해질 필요가 있다. 도함수 표기법은 크게 뉴턴 표기법과 라이프니츠 표기법으로 나뉜다. 아래 표기된 수식을 보자. (1)번 수식이 뉴턴 표기법, (2)번이 라이프니츠의 표기법이다.

$$
y'= 2x\ \ \ \ (1) \\
f'(x) = 2x\ \ \ (2)
$$

이제 아래와 같은 합성함수가 있다고 가정해보자. 도함수의 정의에 따라서 해당 함수에 대한 도함수는 다음과 같이 표현할 수 있을 것이다.

$$
y = g(f(x))\ \ \ (3) \\
y' = {g(f(x))}' = \frac{dy}{dx}\ \ \ (4)
$$

위에 작성한 수식들은 잠시 잊고 이제 $f'(x)$ 를 먼저 생각해보자. $f(x)$에 대한 도함수 $f'(x)$는 다음과 같이 나타낼 수 있다.

$$
u = f(x) \\
u' = f'(x) = \frac{du}{dx} \\
$$

그렇다면 함수 $g$에 대한 도함수는 어떻게 나타낼 수 있을까?? 답은 바로 치환을 이용하는 것이다. 위에서 우리는 $f(x)$가 $u$와 같다고 정의했다. 이것을 이용해 도함수 $g'$는 다음과 같이 나타낼 수 있겠다.

$$
y' = g'(u) = \frac{dy}{du} \\
$$

눈치가 빠르다면 벌써 왜 합성함수 미분법을 `Chain Rule`이라고 부르는지 깨닫게 되었을 것이다. (4)번 수식의 우변은 사실 분자와 분모에 위치한 $du$가 약분된 꼴이라고 볼 수 있다. 이것을 뉴턴 표기법으로 나타내면 아래와 같다.

$$
y' = \frac{dy}{du}•\frac{du}{dx}
$$

뉴턴 표기법은 직관적이지 않기 때문에 라이프니츠 표기법으로 다시 정리하면 다음과 같다.

$$
y' = g'(f(x))•f'(x)
$$

아마 고등학교 때는 합성함수 미분 공식을 겉미분•속미분이라는 명칭으로 처음 접했을 것이다. 안에 감싸져 있는 함수를 미분해서 밖으로 빼낸다 해서 속미분이라 부르고, 다시 속은 냅두고 밖의 둘러져 있는 함수만 미분한다해서 겉미분이라 칭하는데, 이렇게 단순하게 외우기보다는 공식이 도출되는 흐름을 이해하는 것이 훨씬 오래 기억에 남는다. 필자가 바로 그러했다. 대학교에 입학하고 수도 없이 합성함수 미분을 해야할 일이 생겼지만, 사용할 때마다 까먹어서 인터넷을 찾아보거나 교과서를 뒤적뒤적했던 기억이 있다. 이글을 읽는 독자들은 나와 같은 실수를 반복하지 않기를 바라며 포스팅을 마친다.